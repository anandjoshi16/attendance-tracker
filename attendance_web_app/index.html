<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Staff Attendance & Advance Tracker</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to right, #dfe9f3, #ffffff);
      margin: 0; padding: 0;
    }
    header {
      background: #0f172a;
      color: white;
      padding: 15px;
      text-align: center;
    }
    .container {
      padding: 20px;
    }
    .card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      padding: 20px;
      margin-bottom: 20px;
    }
    h2 {
      margin-top: 0;
      color: #0f172a;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: center;
    }
    th {
      background: #0f172a;
      color: white;
    }
    button {
      background: #0f172a;
      color: white;
      padding: 8px 14px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin: 5px;
    }
    button:hover { background: #334155; }
    footer {
      text-align: center;
      padding: 15px;
      background: #f1f5f9;
      font-weight: bold;
    }
    input {
      padding: 6px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
<header>
  <h1>Staff Attendance & Advance Tracker</h1>
</header>

<div class="container">
  <div class="card">
    <h2>Mark Attendance</h2>
    <table id="attendanceTable">
      <thead>
        <tr>
          <th>Staff Name</th>
          <th>Status (Present/Absent)</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <button onclick="saveAttendance()">Save Attendance</button>
  </div>

  <div class="card">
    <h2>Advance Payment</h2>
    <label>Staff: </label>
    <select id="advanceStaff"></select>
    <label>Amount: </label>
    <input type="number" id="advanceAmount">
    <button onclick="addAdvance()">Add Advance</button>
  </div>

  <div class="card">
    <h2>Reports</h2>
    <button onclick="downloadDaily()">Download Daily Report</button>
    <button onclick="downloadMonthly()">Download Monthly Report</button>
    <div id="reportArea"></div>
  </div>
</div>

<footer>
  Made by Anand Joshi
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
  const staffList = ["Anand","Uttam","Sunil","Pravin","Alpesh","Raj","Piyush","Vishwa"];
  let attendanceData = JSON.parse(localStorage.getItem("attendanceData")) || [];
  let advanceData = JSON.parse(localStorage.getItem("advanceData")) || [];

  const tbody = document.querySelector("#attendanceTable tbody");
  const advanceStaff = document.getElementById("advanceStaff");
  
  // Populate staff list
  staffList.forEach(staff=>{
    let row = `<tr>
                <td>${staff}</td>
                <td>
                  <select id="att_${staff}">
                    <option value="Present">Present</option>
                    <option value="Absent">Absent</option>
                  </select>
                </td>
              </tr>`;
    tbody.innerHTML += row;

    let opt = document.createElement("option");
    opt.value = staff; opt.textContent = staff;
    advanceStaff.appendChild(opt);
  });

  function saveAttendance() {
    let today = new Date().toLocaleDateString();
    staffList.forEach(staff=>{
      let status = document.getElementById("att_"+staff).value;
      attendanceData.push({date: today, staff, status});
    });
    localStorage.setItem("attendanceData", JSON.stringify(attendanceData));
    alert("Attendance saved!");
  }

  function addAdvance() {
    let staff = document.getElementById("advanceStaff").value;
    let amount = parseFloat(document.getElementById("advanceAmount").value);
    if (!amount) return alert("Enter valid amount!");
    let today = new Date().toLocaleDateString();
    advanceData.push({date: today, staff, amount});
    localStorage.setItem("advanceData", JSON.stringify(advanceData));
    alert("Advance added!");
  }

  function downloadDaily() {
    let today = new Date().toLocaleDateString();
    let dailyAttendance = attendanceData.filter(r=>r.date===today);
    let dailyAdvance = advanceData.filter(r=>r.date===today);

    let { jsPDF } = window.jspdf;
    let doc = new jsPDF();
    doc.text("Daily Report - "+today, 10, 10);
    doc.text("Attendance:", 10, 20);
    dailyAttendance.forEach((r,i)=> doc.text(`${i+1}. ${r.staff} - ${r.status}`, 10, 30+i*10));
    let offset = 30+dailyAttendance.length*10;
    doc.text("Advance Payments:", 10, offset);
    dailyAdvance.forEach((r,i)=> doc.text(`${i+1}. ${r.staff} - ₹${r.amount}`, 10, offset+10+i*10));
    doc.save("Daily_Report_"+today+".pdf");
  }

  function downloadMonthly() {
    let month = new Date().getMonth();
    let monthlyAttendance = attendanceData.filter(r=> new Date(r.date).getMonth()===month);
    let monthlyAdvance = advanceData.filter(r=> new Date(r.date).getMonth()===month);

    let { jsPDF } = window.jspdf;
    let doc = new jsPDF();
    doc.text("Monthly Report", 10, 10);
    doc.text("Attendance Records:", 10, 20);
    monthlyAttendance.forEach((r,i)=> doc.text(`${i+1}. ${r.date} - ${r.staff} - ${r.status}`, 10, 30+i*10));
    let offset = 30+monthlyAttendance.length*10;
    doc.text("Advance Payments:", 10, offset);
    monthlyAdvance.forEach((r,i)=> doc.text(`${i+1}. ${r.date} - ${r.staff} - ₹${r.amount}`, 10, offset+10+i*10));
    doc.save("Monthly_Report.pdf");
  }
</script>
</body>
</html>
