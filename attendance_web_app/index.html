<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Attendance Tracker</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to right, #00c6ff, #0072ff);
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 900px;
      margin: 30px auto;
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 12px rgba(0,0,0,0.2);
    }
    h2 {
      text-align: center;
      margin-bottom: 20px;
      color: #333;
    }
    .login-box, .attendance-box {
      text-align: center;
    }
    label {
      margin-right: 10px;
    }
    input, select, button {
      margin: 5px;
      padding: 6px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }
    table, th, td {
      border: 1px solid #aaa;
    }
    th, td {
      padding: 8px;
      text-align: center;
    }
    th {
      background: #0072ff;
      color: white;
    }
    .download-buttons {
      margin-top: 20px;
      text-align: center;
    }
    .download-buttons button {
      margin: 5px;
      padding: 10px 15px;
      border: none;
      border-radius: 6px;
      background: #0072ff;
      color: white;
      cursor: pointer;
    }
    .download-buttons button:hover {
      background: #005fcc;
    }
    .footer {
      text-align: center;
      margin-top: 15px;
      color: #444;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Staff Attendance Tracker (Admin)</h2>

    <!-- Login Box -->
    <div class="login-box" id="loginBox">
      <input type="password" id="adminPass" placeholder="Enter Admin Password">
      <button onclick="login()">Login</button>
    </div>

    <!-- Attendance Box -->
    <div class="attendance-box" id="attendanceBox" style="display:none;">
      <label>Staff Name:</label>
      <input type="text" id="staffName" placeholder="Enter Name">
      <label>Time In:</label>
      <input type="time" id="timeIn">
      <label>Time Out:</label>
      <input type="time" id="timeOut">
      <button onclick="addAttendance()">Add Attendance</button>

      <h3>Attendance Records</h3>
      <table id="attendanceTable">
        <thead>
          <tr>
            <th>Date</th>
            <th>Staff</th>
            <th>Time In</th>
            <th>Time Out</th>
            <th>Hours</th>
            <th>Status</th>
            <th>Edit</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <div class="download-buttons">
        <button onclick="downloadReport('daily')">üìÑ Daily Report</button>
        <button onclick="downloadReport('monthly')">üìÑ Monthly Report</button>
        <button onclick="downloadReport('all')">üìÑ All Data Report</button>
      </div>
    </div>

    <div class="footer">Made by Anand Joshi</div>
  </div>

<script>
  let attendanceData = JSON.parse(localStorage.getItem("attendanceData")) || [];

  function login() {
    const pass = document.getElementById("adminPass").value;
    if(pass === "6508") {
      document.getElementById("loginBox").style.display = "none";
      document.getElementById("attendanceBox").style.display = "block";
      renderTable();
    } else {
      alert("Wrong Password!");
    }
  }

  function addAttendance() {
    let name = document.getElementById("staffName").value.trim();
    let timeIn = document.getElementById("timeIn").value;
    let timeOut = document.getElementById("timeOut").value;
    let date = new Date().toLocaleDateString();

    if(!name || !timeIn || !timeOut) {
      alert("Please enter all fields!");
      return;
    }

    let hours = calculateHours(timeIn, timeOut);
    let record = {date, name, timeIn, timeOut, hours, status:"Present"};
    attendanceData.push(record);
    localStorage.setItem("attendanceData", JSON.stringify(attendanceData));
    renderTable();
  }

  function calculateHours(timeIn, timeOut) {
    let [h1,m1] = timeIn.split(":").map(Number);
    let [h2,m2] = timeOut.split(":").map(Number);
    let start = h1*60+m1, end = h2*60+m2;
    let diff = (end-start)/60;
    return diff.toFixed(2);
  }

  function renderTable() {
    let tbody = document.querySelector("#attendanceTable tbody");
    tbody.innerHTML = "";
    attendanceData.forEach((rec, i) => {
      let tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${rec.date}</td>
        <td>${rec.name}</td>
        <td>${rec.timeIn}</td>
        <td>${rec.timeOut}</td>
        <td>${rec.hours}</td>
        <td>${rec.status}</td>
        <td><button onclick="editRecord(${i})">‚úèÔ∏è Edit</button></td>
      `;
      tbody.appendChild(tr);
    });
  }

  function editRecord(index) {
    let rec = attendanceData[index];
    let newIn = prompt("Edit Time In (HH:MM)", rec.timeIn);
    let newOut = prompt("Edit Time Out (HH:MM)", rec.timeOut);
    if(newIn && newOut) {
      rec.timeIn = newIn;
      rec.timeOut = newOut;
      rec.hours = calculateHours(newIn,newOut);
      attendanceData[index] = rec;
      localStorage.setItem("attendanceData", JSON.stringify(attendanceData));
      renderTable();
    }
  }

  function downloadReport(type) {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    let today = new Date().toLocaleDateString();
    let month = new Date().getMonth()+1;
    let year = new Date().getFullYear();

    let data = [];
    if(type==="daily") {
      data = attendanceData.filter(r=>r.date===today);
      doc.text(`Daily Attendance Report (${today})`, 10, 10);
    } else if(type==="monthly") {
      data = attendanceData.filter(r=>r.date.split("/")[0]==month);
      doc.text(`Monthly Attendance Report (${month}/${year})`, 10, 10);
    } else {
      data = attendanceData;
      doc.text(`All Data Attendance Report`, 10, 10);
    }

    let y=20;
    data.forEach(r=>{
      doc.text(`${r.date} | ${r.name} | In: ${r.timeIn} | Out: ${r.timeOut} | Hours: ${r.hours} | ${r.status}`, 10, y);
      y+=10;
    });

    doc.save(`${type}_attendance.pdf`);
  }
</script>
</body>
</html>
