<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Attendance Tracker</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #6dd5ed, #2193b0);
      color: #fff;
      margin: 0;
      padding: 0;
      text-align: center;
    }
    .container {
      margin: 40px auto;
      padding: 20px;
      max-width: 500px;
      background: rgba(0,0,0,0.6);
      border-radius: 12px;
    }
    h2 { margin-bottom: 20px; }
    input, select, button {
      padding: 10px;
      margin: 8px;
      width: 90%;
      border: none;
      border-radius: 8px;
    }
    button {
      background: #ff9800;
      color: white;
      cursor: pointer;
    }
    button:hover { background: #e68900; }
    .hidden { display: none; }
    table {
      width: 100%;
      margin-top: 15px;
      border-collapse: collapse;
      background: white;
      color: black;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 6px;
      text-align: center;
    }
    footer {
      margin-top: 20px;
      padding: 10px;
      font-size: 14px;
      color: #eee;
    }
  </style>
</head>
<body>

  <!-- LOGIN -->
  <div id="loginPage" class="container">
    <h2>Login</h2>
    <input type="text" id="loginId" placeholder="Enter ID">
    <input type="password" id="loginPassword" placeholder="Enter Password">
    <button onclick="login()">Login</button>
    <p id="loginError" style="color:red;"></p>
  </div>

  <!-- ADMIN PANEL -->
  <div id="adminPanel" class="container hidden">
    <h2>Admin Panel</h2>
    <h3>Attendance Management</h3>
    <select id="staffSelect"></select>
    <input type="date" id="dateInput">
    <input type="time" id="timeInInput" placeholder="Time In">
    <input type="time" id="timeOutInput" placeholder="Time Out">
    <input type="number" id="advanceInput" placeholder="Advance Amount">
    <button onclick="markAttendance()">Save Attendance</button>

    <h3>Attendance Records</h3>
    <table id="attendanceTable">
      <tr>
        <th>Date</th>
        <th>Staff</th>
        <th>Time In</th>
        <th>Time Out</th>
        <th>Hours</th>
        <th>Advance</th>
      </tr>
    </table>
  </div>

  <!-- STAFF PANEL -->
  <div id="staffPanel" class="container hidden">
    <h2>Staff Panel</h2>
    <p id="staffWelcome"></p>
    <button onclick="staffMarkIn()">Mark Time In</button>
    <button onclick="staffMarkOut()">Mark Time Out</button>
    <table id="staffAttendanceTable">
      <tr>
        <th>Date</th>
        <th>Time In</th>
        <th>Time Out</th>
        <th>Hours</th>
      </tr>
    </table>
  </div>

  <footer>Made by Anand Joshi</footer>

  <script>
    // Fixed Staff list
    const staffList = ["Anand", "Uttam", "Sunil", "Pravin", "Alpesh", "Raj", "Piyush", "Vishwa"];
    const attendanceData = JSON.parse(localStorage.getItem("attendanceData")) || [];

    const loginPage = document.getElementById("loginPage");
    const adminPanel = document.getElementById("adminPanel");
    const staffPanel = document.getElementById("staffPanel");

    const staffSelect = document.getElementById("staffSelect");
    staffList.forEach(name => {
      let opt = document.createElement("option");
      opt.value = name;
      opt.textContent = name;
      staffSelect.appendChild(opt);
    });

    let currentUser = null;

    function login() {
      const id = document.getElementById("loginId").value;
      const pass = document.getElementById("loginPassword").value;

      if (id === "anandjoshi@123" && pass === "6508") {
        loginPage.classList.add("hidden");
        adminPanel.classList.remove("hidden");
        renderAttendanceTable();
      } else if (id === "anand@123" && pass === "1515") {
        currentUser = "Anand"; // Example: staff Anand
        loginPage.classList.add("hidden");
        staffPanel.classList.remove("hidden");
        document.getElementById("staffWelcome").innerText = "Welcome, " + currentUser;
        renderStaffTable();
      } else {
        document.getElementById("loginError").innerText = "Invalid credentials!";
      }
    }

    function markAttendance() {
      const staff = document.getElementById("staffSelect").value;
      const date = document.getElementById("dateInput").value;
      const timeIn = document.getElementById("timeInInput").value;
      const timeOut = document.getElementById("timeOutInput").value;
      const advance = document.getElementById("advanceInput").value;

      if (!date) return alert("Please select a date");

      let hours = "";
      if (timeIn && timeOut) {
        let start = new Date("1970-01-01T" + timeIn + ":00");
        let end = new Date("1970-01-01T" + timeOut + ":00");
        let diff = (end - start) / (1000 * 60 * 60);
        hours = diff.toFixed(2);
      }

      attendanceData.push({date, staff, timeIn, timeOut, hours, advance});
      localStorage.setItem("attendanceData", JSON.stringify(attendanceData));
      renderAttendanceTable();
    }

    function renderAttendanceTable() {
      const table = document.getElementById("attendanceTable");
      table.innerHTML = `
        <tr>
          <th>Date</th><th>Staff</th><th>Time In</th><th>Time Out</th><th>Hours</th><th>Advance</th>
        </tr>`;
      attendanceData.forEach(r => {
        table.innerHTML += `<tr>
          <td>${r.date}</td><td>${r.staff}</td><td>${r.timeIn}</td>
          <td>${r.timeOut}</td><td>${r.hours}</td><td>${r.advance || 0}</td>
        </tr>`;
      });
    }

    function staffMarkIn() {
      const today = new Date().toISOString().split("T")[0];
      const now = new Date().toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'});
      attendanceData.push({date: today, staff: currentUser, timeIn: now, timeOut: "", hours:"", advance:0});
      localStorage.setItem("attendanceData", JSON.stringify(attendanceData));
      renderStaffTable();
    }

    function staffMarkOut() {
      const today = new Date().toISOString().split("T")[0];
      let record = attendanceData.find(r => r.date === today && r.staff === currentUser);
      if (record) {
        record.timeOut = new Date().toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'});
        let start = new Date("1970-01-01T" + record.timeIn + ":00");
        let end = new Date("1970-01-01T" + record.timeOut + ":00");
        let diff = (end - start) / (1000 * 60 * 60);
        record.hours = diff.toFixed(2);
        localStorage.setItem("attendanceData", JSON.stringify(attendanceData));
        renderStaffTable();
      }
    }

    function renderStaffTable() {
      const table = document.getElementById("staffAttendanceTable");
      table.innerHTML = `<tr><th>Date</th><th>Time In</th><th>Time Out</th><th>Hours</th></tr>`;
      attendanceData.filter(r => r.staff === currentUser).forEach(r => {
        table.innerHTML += `<tr>
          <td>${r.date}</td><td>${r.timeIn}</td><td>${r.timeOut}</td><td>${r.hours}</td>
        </tr>`;
      });
    }
  </script>
</body>
</html>
