<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Staff Attendance Tracker</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #74ebd5, #ACB6E5);
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    header {
      background: #333;
      color: white;
      padding: 10px;
      text-align: center;
    }
    .container {
      flex: 1;
      padding: 20px;
    }
    .login-box, .dashboard, .staff-panel {
      max-width: 500px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0px 0px 10px rgba(0,0,0,0.2);
      display: none;
    }
    .login-box.active, .dashboard.active, .staff-panel.active {
      display: block;
    }
    input, button, select {
      padding: 10px;
      margin: 5px 0;
      width: 100%;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    button {
      background: #333;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background: #555;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }
    th, td {
      border: 1px solid #999;
      padding: 8px;
      text-align: center;
    }
    footer {
      text-align: center;
      padding: 10px;
      background: #333;
      color: white;
    }
  </style>
</head>
<body>

<header>
  <h1>Staff Attendance Tracker</h1>
</header>

<div class="container">

  <!-- Login Box -->
  <div id="loginBox" class="login-box active">
    <h2>Login</h2>
    <input type="text" id="loginId" placeholder="Enter ID">
    <input type="password" id="loginPass" placeholder="Enter Password">
    <button onclick="login()">Login</button>
  </div>

  <!-- Admin Dashboard -->
  <div id="adminDashboard" class="dashboard">
    <h2>Admin Dashboard</h2>
    <button onclick="logout()">Logout</button>
    <h3>Staff Attendance</h3>
    <table id="attendanceTable">
      <thead>
        <tr>
          <th>Name</th>
          <th>Status</th>
          <th>Time In</th>
          <th>Time Out</th>
          <th>Advance Given</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <button onclick="downloadReport('daily')">Download Daily Report</button>
    <button onclick="downloadReport('monthly')">Download Monthly Report</button>
  </div>

  <!-- Staff Panel -->
  <div id="staffPanel" class="staff-panel">
    <h2>Staff Panel</h2>
    <p id="staffName"></p>
    <button onclick="markPresent()">Mark Present</button>
    <button onclick="markAbsent()">Mark Absent</button>
    <button onclick="markLogout()">Mark Logout</button>
    <button onclick="logout()">Logout</button>
    <h3>Your Attendance</h3>
    <table id="staffAttendance">
      <thead>
        <tr>
          <th>Date</th>
          <th>Status</th>
          <th>In</th>
          <th>Out</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

</div>

<footer>
  Made by Anand Joshi
</footer>

<script>
  // Staff List
  const staffList = ["Anand","Uttam","Sunil","Pravin","Alpesh","Raj","Piyush","Vishwa"];
  let attendanceData = JSON.parse(localStorage.getItem("attendance")) || {};
  let currentUser = null;

  function login() {
    const id = document.getElementById("loginId").value;
    const pass = document.getElementById("loginPass").value;

    // Admin login
    if (id === "anandjoshi@123" && pass === "6508") {
      currentUser = { role: "admin" };
      document.getElementById("loginBox").classList.remove("active");
      document.getElementById("adminDashboard").classList.add("active");
      loadAdminTable();
      return;
    }

    // Staff login
    if (id === "anand@123" && pass === "1515") {
      currentUser = { role: "staff", name: "Anand" }; // only one staff login for demo
      document.getElementById("loginBox").classList.remove("active");
      document.getElementById("staffPanel").classList.add("active");
      document.getElementById("staffName").innerText = "Welcome, " + currentUser.name;
      loadStaffTable();
      return;
    }

    alert("Invalid credentials!");
  }

  function logout() {
    currentUser = null;
    document.getElementById("loginBox").classList.add("active");
    document.getElementById("adminDashboard").classList.remove("active");
    document.getElementById("staffPanel").classList.remove("active");
  }

  function markPresent() {
    const date = new Date().toLocaleDateString();
    const time = new Date().toLocaleTimeString();
    if (!attendanceData[date]) attendanceData[date] = {};
    attendanceData[date][currentUser.name] = {status: "Present", in: time, out: ""};
    saveData();
    loadStaffTable();
    alert("Present marked at " + time);
  }

  function markAbsent() {
    const date = new Date().toLocaleDateString();
    if (!attendanceData[date]) attendanceData[date] = {};
    attendanceData[date][currentUser.name] = {status: "Absent", in: "", out: ""};
    saveData();
    loadStaffTable();
    alert("Absent marked.");
  }

  function markLogout() {
    const date = new Date().toLocaleDateString();
    const time = new Date().toLocaleTimeString();
    if (attendanceData[date] && attendanceData[date][currentUser.name]) {
      attendanceData[date][currentUser.name].out = time;
      saveData();
      loadStaffTable();
      alert("Logout marked at " + time);
    }
  }

  function loadAdminTable() {
    const tbody = document.querySelector("#attendanceTable tbody");
    tbody.innerHTML = "";
    staffList.forEach(staff => {
      let row = `<tr>
        <td>${staff}</td>
        <td>-</td>
        <td>-</td>
        <td>-</td>
        <td><input type='number' placeholder='Advance' onchange='updateAdvance("${staff}", this.value)'></td>
      </tr>`;
      tbody.innerHTML += row;
    });
  }

  function loadStaffTable() {
    const tbody = document.querySelector("#staffAttendance tbody");
    tbody.innerHTML = "";
    for (let date in attendanceData) {
      if (attendanceData[date][currentUser.name]) {
        let rec = attendanceData[date][currentUser.name];
        tbody.innerHTML += `<tr>
          <td>${date}</td>
          <td>${rec.status}</td>
          <td>${rec.in}</td>
          <td>${rec.out}</td>
        </tr>`;
      }
    }
  }

  function updateAdvance(staff, value) {
    const date = new Date().toLocaleDateString();
    if (!attendanceData[date]) attendanceData[date] = {};
    if (!attendanceData[date][staff]) attendanceData[date][staff] = {status:"", in:"", out:""};
    attendanceData[date][staff].advance = value;
    saveData();
  }

  function downloadReport(type) {
    let dataStr = JSON.stringify(attendanceData, null, 2);
    let blob = new Blob([dataStr], {type: "application/json"});
    let url = URL.createObjectURL(blob);
    let a = document.createElement("a");
    a.href = url;
    a.download = type + "_report.json";
    a.click();
  }

  function saveData() {
    localStorage.setItem("attendance", JSON.stringify(attendanceData));
  }
</script>

</body>
</html>
